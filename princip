from fuzzywuzzy import fuzz
import unicodedata
import string



faq = {
    # Horário de atendimento
    ("horario de atendimento",
     "horario atendimento",
     "horas do atendimento",
     "horas atendimento"): "O horário de atendimento de todas as unidades é de 9:00 ás 19:00 horas.",

    # Sedes no Brasil
    ("sedes no brasil",
     "sedes do brasil",
     "sedes da empresa",
     "sedes dessa empresa"): "A Etical Enterprises tem 5 sedes espalhadas pelo Brasil. Uma no Rio de Janeiro, duas em São Paulo e duas no Ceará.",

    # Rio de Janeiro - Localização
    ("sede no rio de janeiro",
     "sede do rio de janeiro",
     "sede rio de janeiro",
     "rio de janeiro sede"): "A sede do Rio de Janeiro fica na rua De Leonardo Pravo, N* 1500, Nerlin, São Gonçalo, e funciona das 9:00 ás 19:00 horas.",

    # Rio de Janeiro - São Gonçalo - Horários
    ("horario de sede no rio de janeiro",
     "horario da sede no rio de janeiro",
     "horario de atendimento rio de janeiro",
     "até que horas no rio de janeiro",
     "horario de sede em sao gonçalo",
     "horario da sede em sao gonçalo",
     "horario de atendimento sao gonçalo",
     "até que horas em sao gonçalo"): "O horário de funcionamento da sede na cidade de São Gonçalo é das 9:00 até as 19:00 horas.",

    # Rio de Janeiro - São Gonçalo - Local
    ("rua da sede no rio de janeiro",
     "a sede do rio de janeiro",
     "local da da sede no rio de janeiro",
     "localidade da sede no rio de janeiro",
     "endereço da sede no rio de janeiro",
     "rua da sede em sao gonçalo",
     "a sede de sao gonçalo",
     "a sede em sao gonçalo",
     "local da da sede em sao gonçalo",
     "localidade da sede em sao gonçalo",
     "endereço da sede em sao gonçalo"): "A sede do Rio de Janeiro fica na rua De Leonardo Pravo, N* 1500, Nerlin, São Gonçalo.",

    # São Paulo - Localização geral
    ("sedes em sao paulo",
     "sedes de sao paulo",
     "sedes sao paulo",
     "sao paulo sedes"): "As sedes em São Paulo ficam ambas na cidade de São Paulo, uma no bairro Liberdade e outra no Centro,.",

    # São Paulo - Centro - Horários
    ("horario de sede no centro",
     "horario da sede no centro",
     "horário de atendimento centro",
     "até que horas no centro"): "O horário de funcionamento da sede na cidade de São Paulo é das 9:00 até as 19:00 horas.",

    # São Paulo - Centro - Local
    ("rua da sede no centro",
     "a sede no centro",
     "local da da sede no centro",
     "localidade da sede no centro",
     "endereço da sede no centro"): "A sede no Centro de São Paulo fica na Rua Moçarique Medeiros, N* 1390, Centro, São Paulo.",

    # São Paulo - Guarulhos - Horários
    ("horario de sede em guarulhos",
     "horario da sede em guarulhos",
     "horário de atendimento guarulhos",
     "até que horas em guarulhos"): "O horário de funcionamento da sede em Guarulhos é das 9:00 até as 19:00 horas.",

    # São Paulo - Guarulhos - Local
    ("rua da sede em guarulhos",
     "a sede em guarulhos",
     "local da da sede em guarulhos",
     "localidade da sede em guarulhos",
     "endereço da sede em guarulhos"): "A sede em Guarulhos fica na Rua Marvelick, N* 349, Liberdade, São Paulo.",

    # Ceará - Localização geral
    ("sedes no ceara",
     "sedes do ceara",
     "sede do ceara",
     "ceara sedes",
     "sedes ceara"): "As sedes do Ceará ficam nas cidades de Fortaleza, Aldeota, e Maracanaú, Pajuçara.",

    # Ceará - Fortaleza - Horários
    ("horario da sede em fortaleza",
     "horario da sede em fortaleza",
     "horário de atendimento sede fortaleza",
     "até que horas em fortaleza"): "O horário de funcionamento da sede em fortaleza é das 9:00 até as 19:00 horas.",


    # Ceará - Fortaleza - Local
    ("rua da sede em fortaleza",
     "a sede em fortaleza",
     "local da da sede em fortaleza",
     "localidade da sede em fortaleza",
     "endereço da sede em fortaleza",
     "rua da sede de fortaleza",
     "local da da sede de fortaleza",
     "localidade da sede de fortaleza",
     "endereço da sede de fortaleza"): "A sede na cidade de Fortaleza fica na Rua Leopodina da Assunção, N* 472, Aldeota, Fortaleza.",

    # Ceará - Maracanaú - Horários
    ("horario de sede em maracanau",
     "horario da sede em maracanau",
     "horário de atendimento sede em maracanau",
     "até que horas em maracanau") : "O horário de funcionamento da sede em Maracanaú é das 9:00 até as 19:00 horas",


    # Ceará - Maracanaú - Local
    ("rua da sede no maracanau",
     "a sede em maracanau",
     "rua da sede no maracanau",
     "local da sede no maracanau",
     "endereço da sede no maracanau"
     "rua da sede em maracanau",
     "rua da sede em maracanau",
     "local da sede em maracanau",
     "endereço da sede em maracanau"): "A sede na cidade de Maracanaú fica na rua Padre Figueiredo, N* 668, Pajuçara, Fortaleza.",
}


def retirar_acento(texto):
    return "".join(c for c in unicodedata.normalize('NFD', texto) if unicodedata.category(c) != 'Mn')


def encontrar_resposta(pergunta):
    pergunta = retirar_acento(pergunta.lower().translate(str.maketrans("", "", string.punctuation)))
    tokens_pergunta = set(pergunta.split())

    melhor_resposta = None
    melhor_score = 0

    for palavra_chave, resposta in faq.items():
      tokens_chave = set(" ".join(palavra_chave).split())
      score = len(tokens_pergunta.intersection(tokens_chave))

      for palavra in palavra_chave:
        similaridade = fuzz.partial_ratio(palavra, pergunta)
        if similaridade > 90:
          score += 1

      if score > melhor_score:
        melhor_score = score
        melhor_resposta = resposta

    if melhor_score > 0:
      return melhor_resposta
    else:
      return "Desculpe, não entendi sua pergunta."


while True:
    pergunta = input("Digite sua pergunta: ")
    resposta = encontrar_resposta(pergunta)
    print(resposta)

    confirm = input("Deseja fazer mais alguma pergunta? S/N: ")
    confirm = confirm.upper()
    if confirm == "N":
      break
